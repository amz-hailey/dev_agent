<!DOCTYPE html>
<html lang="ko" class="h-full">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenOS — 알림 관리</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css">
    <script>tailwind.config={theme:{extend:{fontFamily:{sans:['Pretendard Variable','Inter','system-ui','sans-serif']}}}}</script>
    <style>.scrollbar-thin::-webkit-scrollbar{width:4px}.scrollbar-thin::-webkit-scrollbar-thumb{background:#e2e8f0;border-radius:2px}</style>
</head>
<body class="h-full bg-slate-50 font-sans antialiased">
<div x-data="alertMgmt()" x-init="init()" class="flex h-full min-h-screen">
    <!-- SIDEBAR -->
    <aside class="w-[240px] bg-white border-r border-slate-200 flex flex-col flex-shrink-0 h-screen sticky top-0">
        <div class="h-16 flex items-center gap-2.5 px-5 border-b border-slate-100"><div class="w-8 h-8 rounded-lg bg-slate-900 flex items-center justify-center"><i data-lucide="shield-check" class="w-5 h-5 text-white"></i></div><span class="text-lg font-bold text-slate-900">GenOS</span></div>
        <nav class="flex-1 overflow-y-auto scrollbar-thin py-4 px-3">
            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider px-2 mb-1.5">보안 운영</p>
            <a href="PG-02_dashboard.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 mb-0.5"><i data-lucide="layout-dashboard" class="w-4 h-4"></i>메인 대시보드</a>
            <a href="PG-06_realtime_monitoring.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 mb-0.5"><i data-lucide="activity" class="w-4 h-4"></i>실시간 모니터링</a>
            <a href="PG-07_alert_management.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm font-medium bg-slate-100 text-slate-900 mb-0.5"><i data-lucide="bell" class="w-4 h-4"></i>알림 관리</a>
            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider px-2 mb-1.5 mt-5">에이전트 관리</p>
            <a href="PG-03_agent_templates.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 mb-0.5"><i data-lucide="boxes" class="w-4 h-4"></i>템플릿 라이브러리</a>
            <a href="PG-04_deploy_wizard.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 mb-0.5"><i data-lucide="rocket" class="w-4 h-4"></i>배포 위저드</a>
            <a href="PG-05_connector_hub.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 mb-0.5"><i data-lucide="plug" class="w-4 h-4"></i>커넥터 허브</a>
            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider px-2 mb-1.5 mt-5">리포팅 · 감사</p>
            <a href="PG-08_compliance_reports.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 mb-0.5"><i data-lucide="file-text" class="w-4 h-4"></i>컴플라이언스 리포트</a>
            <a href="PG-09_audit_log.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 mb-0.5"><i data-lucide="scroll-text" class="w-4 h-4"></i>감사 로그</a>
            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider px-2 mb-1.5 mt-5">시스템 관리</p>
            <a href="PG-10_user_permissions.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 mb-0.5"><i data-lucide="users" class="w-4 h-4"></i>사용자/권한</a>
            <a href="PG-11_system_dr.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 mb-0.5"><i data-lucide="server" class="w-4 h-4"></i>시스템/DR</a>
            <a href="PG-12_settings.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 mb-0.5"><i data-lucide="settings" class="w-4 h-4"></i>설정</a>
        </nav>
        <div class="border-t border-slate-100 p-3"><div class="flex items-center gap-2.5 px-2 py-1.5"><div class="w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-xs font-bold text-slate-600">김</div><div class="flex-1 min-w-0"><p class="text-sm font-medium text-slate-900 truncate">김부장</p><p class="text-[11px] text-slate-400">IT 보안팀</p></div></div></div>
    </aside>

    <main class="flex-1 flex flex-col min-w-0">
        <header class="h-16 bg-white border-b border-slate-200 flex items-center justify-between px-6 flex-shrink-0">
            <div><h1 class="text-lg font-bold text-slate-900">알림 관리</h1><p class="text-xs text-slate-400 -mt-0.5">다채널 알림 설정 · 에스컬레이션 · 이력</p></div>
        </header>

        <div class="flex-1 overflow-y-auto p-6">
            <!-- Tabs -->
            <div class="flex items-center gap-1 bg-slate-100 rounded-lg p-0.5 w-fit mb-6">
                <template x-for="t in [{v:'channels',l:'채널 설정'},{v:'escalation',l:'에스컬레이션 규칙'},{v:'history',l:'알림 이력'}]" :key="t.v">
                    <button @click="activeTab=t.v" class="px-4 py-1.5 text-sm font-medium rounded-md transition-colors" :class="activeTab===t.v ? 'bg-white text-slate-900 shadow-sm' : 'text-slate-500 hover:text-slate-700'" x-text="t.l"></button>
                </template>
            </div>

            <!-- Channel Settings -->
            <div x-show="activeTab==='channels'" class="space-y-4">
                <template x-for="ch in channels" :key="ch.id">
                    <div class="bg-white rounded-xl border border-slate-200 p-5">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <div class="w-9 h-9 rounded-lg flex items-center justify-center" :class="ch.iconBg"><i :data-lucide="ch.icon" class="w-5 h-5" :class="ch.iconColor"></i></div>
                                <div><h3 class="text-sm font-semibold text-slate-900" x-text="ch.name"></h3><p class="text-xs text-slate-400" x-text="ch.desc"></p></div>
                            </div>
                            <button @click="ch.enabled=!ch.enabled" :class="ch.enabled ? 'bg-slate-900' : 'bg-slate-200'" class="w-9 h-5 rounded-full relative transition-colors">
                                <span :class="ch.enabled ? 'translate-x-4' : 'translate-x-0.5'" class="block w-4 h-4 bg-white rounded-full shadow transition-transform"></span>
                            </button>
                        </div>
                        <div x-show="ch.enabled" x-transition class="space-y-3 pt-3 border-t border-slate-100">
                            <div><label class="block text-xs font-medium text-slate-500 mb-1" x-text="ch.urlLabel"></label><input type="text" :value="ch.url" class="h-9 w-full rounded-md border border-slate-200 px-3 text-sm font-mono focus:outline-none focus:ring-2 focus:ring-slate-900 focus:ring-offset-1" :placeholder="ch.urlPlaceholder"></div>
                            <div><label class="block text-xs font-medium text-slate-500 mb-1">심각도 필터</label>
                                <div class="flex gap-1.5">
                                    <template x-for="s in ['긴급','높음','보통','낮음','정보']" :key="s">
                                        <button @click="toggleChannelSev(ch,s)" class="px-2 py-0.5 text-[11px] font-medium rounded-full border transition-colors" :class="ch.severities.includes(s)?'bg-slate-900 text-white border-slate-900':'border-slate-200 text-slate-500'" x-text="s"></button>
                                    </template>
                                </div>
                            </div>
                            <button class="h-8 px-3 rounded-md border border-slate-200 text-xs font-medium text-slate-600 hover:bg-slate-50 transition-colors inline-flex items-center gap-1.5"><i data-lucide="send" class="w-3 h-3"></i> 테스트 전송</button>
                        </div>
                    </div>
                </template>
            </div>

            <!-- Escalation Rules -->
            <div x-show="activeTab==='escalation'" class="space-y-4">
                <div class="flex items-center justify-between mb-2">
                    <p class="text-sm text-slate-500">우선순위 순으로 실행됩니다. 드래그로 순서를 변경하세요.</p>
                    <button class="h-9 px-4 rounded-md bg-slate-900 text-sm font-medium text-white hover:bg-slate-800 transition-colors inline-flex items-center gap-1.5"><i data-lucide="plus" class="w-4 h-4"></i> 규칙 추가</button>
                </div>
                <template x-for="(rule, idx) in escalationRules" :key="rule.id">
                    <div class="bg-white rounded-xl border border-slate-200 p-5">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center gap-2">
                                <span class="w-6 h-6 rounded-full bg-slate-100 text-[11px] font-bold text-slate-500 flex items-center justify-center" x-text="idx+1"></span>
                                <h3 class="text-sm font-semibold text-slate-900" x-text="rule.name"></h3>
                                <span class="text-[10px] font-medium px-1.5 py-0.5 rounded-full" :class="rule.enabled ? 'bg-emerald-50 text-emerald-700' : 'bg-slate-100 text-slate-400'" x-text="rule.enabled ? '활성' : '비활성'"></span>
                            </div>
                            <button @click="rule.enabled=!rule.enabled" :class="rule.enabled ? 'bg-slate-900' : 'bg-slate-200'" class="w-9 h-5 rounded-full relative transition-colors"><span :class="rule.enabled ? 'translate-x-4' : 'translate-x-0.5'" class="block w-4 h-4 bg-white rounded-full shadow transition-transform"></span></button>
                        </div>
                        <div class="grid grid-cols-2 gap-3 text-xs">
                            <div class="rounded-lg bg-slate-50 p-3"><span class="text-slate-400">조건</span><p class="text-slate-700 font-medium mt-0.5" x-text="rule.condition"></p></div>
                            <div class="rounded-lg bg-slate-50 p-3"><span class="text-slate-400">액션</span><p class="text-slate-700 font-medium mt-0.5" x-text="rule.action"></p></div>
                        </div>
                    </div>
                </template>
            </div>

            <!-- Alert History -->
            <div x-show="activeTab==='history'">
                <div class="flex items-center gap-3 mb-4">
                    <select class="h-9 rounded-md border border-slate-200 px-3 text-sm"><option>전체 채널</option><option>Slack</option><option>Email</option><option>SMS</option></select>
                    <select class="h-9 rounded-md border border-slate-200 px-3 text-sm"><option>전체 심각도</option><option>긴급</option><option>높음</option><option>보통</option></select>
                    <select class="h-9 rounded-md border border-slate-200 px-3 text-sm"><option>전체 상태</option><option>전송 완료</option><option>전송 실패</option></select>
                    <button class="h-9 px-3 rounded-md border border-slate-200 text-xs font-medium text-slate-600 hover:bg-slate-50 inline-flex items-center gap-1.5"><i data-lucide="download" class="w-3.5 h-3.5"></i> CSV 내보내기</button>
                </div>
                <div class="bg-white rounded-xl border border-slate-200 overflow-hidden">
                    <table class="w-full text-sm">
                        <thead class="bg-slate-50 border-b border-slate-200"><tr>
                            <th class="text-left px-4 py-3 text-xs font-medium text-slate-500">전송 시각</th>
                            <th class="text-left px-4 py-3 text-xs font-medium text-slate-500">채널</th>
                            <th class="text-left px-4 py-3 text-xs font-medium text-slate-500">심각도</th>
                            <th class="text-left px-4 py-3 text-xs font-medium text-slate-500">내용</th>
                            <th class="text-left px-4 py-3 text-xs font-medium text-slate-500">수신자</th>
                            <th class="text-left px-4 py-3 text-xs font-medium text-slate-500">상태</th>
                        </tr></thead>
                        <tbody class="divide-y divide-slate-100">
                            <template x-for="h in alertHistory" :key="h.id">
                                <tr class="hover:bg-slate-50">
                                    <td class="px-4 py-3 text-xs font-mono text-slate-500" x-text="h.time"></td>
                                    <td class="px-4 py-3"><span class="text-[10px] font-medium px-1.5 py-0.5 rounded-full" :class="h.channelBadge" x-text="h.channel"></span></td>
                                    <td class="px-4 py-3"><span class="text-[10px] font-medium px-1.5 py-0.5 rounded-full" :class="h.sevBadge" x-text="h.severity"></span></td>
                                    <td class="px-4 py-3 text-xs text-slate-700 max-w-[300px] truncate" x-text="h.message"></td>
                                    <td class="px-4 py-3 text-xs text-slate-500" x-text="h.recipient"></td>
                                    <td class="px-4 py-3"><span class="text-[10px] font-medium px-1.5 py-0.5 rounded-full" :class="h.statusBadge" x-text="h.status"></span></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>
</div>
<script>
document.addEventListener('alpine:init',()=>{setTimeout(()=>lucide.createIcons(),50)});
const _o=new MutationObserver(()=>lucide.createIcons());_o.observe(document.body,{childList:true,subtree:true});
function alertMgmt(){
    return {
        activeTab:'escalation',
        channels:[
            {id:'slack',name:'Slack',desc:'Webhook 연동',icon:'hash',iconBg:'bg-purple-100',iconColor:'text-purple-600',enabled:true,url:'https://hooks.slack.com/services/T0****/B0****/xxxx',urlLabel:'Webhook URL',urlPlaceholder:'https://hooks.slack.com/...',severities:['긴급','높음','보통']},
            {id:'teams',name:'Microsoft Teams',desc:'Webhook 연동',icon:'message-square',iconBg:'bg-blue-100',iconColor:'text-blue-600',enabled:true,url:'https://outlook.office.com/webhook/****',urlLabel:'Webhook URL',urlPlaceholder:'https://outlook.office.com/...',severities:['긴급','높음']},
            {id:'email',name:'Email',desc:'SMTP 메일 발송',icon:'mail',iconBg:'bg-amber-100',iconColor:'text-amber-600',enabled:true,url:'security-team@kbbank.co.kr, ciso@kbbank.co.kr',urlLabel:'수신자 (쉼표 구분)',urlPlaceholder:'email@example.com',severities:['긴급','높음','보통','낮음']},
            {id:'sms',name:'SMS',desc:'긴급 문자 알림',icon:'smartphone',iconBg:'bg-red-100',iconColor:'text-red-600',enabled:true,url:'010-****-1234, 010-****-5678',urlLabel:'수신자 번호 (쉼표 구분)',urlPlaceholder:'010-1234-5678',severities:['긴급','높음']},
        ],
        escalationRules:[
            {id:'r1',name:'긴급 알림 미처리 15분',condition:'심각도 = 긴급 AND 미처리 >= 15분',action:'SMS → CISO, L2 에스컬레이션',enabled:true},
            {id:'r2',name:'높음 알림 미처리 30분',condition:'심각도 = 높음 AND 미처리 >= 30분',action:'Email + Slack → 팀장, L2 에스컬레이션',enabled:true},
            {id:'r3',name:'동일 유형 3건 이상',condition:'동일 탐지 유형 1시간 내 3건 이상',action:'Slack → 전체 보안팀, L1 에스컬레이션',enabled:true},
            {id:'r4',name:'에이전트 장애',condition:'에이전트 Health = UNHEALTHY',action:'Email + SMS → 시스템 운영팀',enabled:false},
        ],
        alertHistory:[
            {id:1,time:'14:32:08',channel:'Slack',channelBadge:'bg-purple-50 text-purple-700',severity:'긴급',sevBadge:'bg-red-100 text-red-700',message:'[FDS] 비정상 거래 패턴 — 동일 계좌 15회 이체',recipient:'#security-alerts',status:'전송 완료',statusBadge:'bg-emerald-50 text-emerald-700'},
            {id:2,time:'14:32:08',channel:'Email',channelBadge:'bg-amber-50 text-amber-700',severity:'긴급',sevBadge:'bg-red-100 text-red-700',message:'[FDS] 비정상 거래 패턴 — 동일 계좌 15회 이체',recipient:'security-team@kbbank.co.kr',status:'전송 완료',statusBadge:'bg-emerald-50 text-emerald-700'},
            {id:3,time:'14:32:09',channel:'SMS',channelBadge:'bg-red-50 text-red-700',severity:'긴급',sevBadge:'bg-red-100 text-red-700',message:'[FDS] 비정상 거래 패턴 감지',recipient:'010-****-1234',status:'전송 완료',statusBadge:'bg-emerald-50 text-emerald-700'},
            {id:4,time:'14:28:42',channel:'Slack',channelBadge:'bg-purple-50 text-purple-700',severity:'높음',sevBadge:'bg-orange-100 text-orange-700',message:'[AML] 고위험 거래 의심 — 해외 송금 연속',recipient:'#security-alerts',status:'전송 완료',statusBadge:'bg-emerald-50 text-emerald-700'},
            {id:5,time:'14:22:16',channel:'SMS',channelBadge:'bg-red-50 text-red-700',severity:'긴급',sevBadge:'bg-red-100 text-red-700',message:'[접근이상] 비인가 IP 관리자 접근',recipient:'010-****-1234',status:'전송 실패',statusBadge:'bg-red-50 text-red-700'},
            {id:6,time:'14:15:34',channel:'Email',channelBadge:'bg-amber-50 text-amber-700',severity:'보통',sevBadge:'bg-amber-100 text-amber-700',message:'[FDS] 야간 대량 조회 감지',recipient:'security-team@kbbank.co.kr',status:'전송 완료',statusBadge:'bg-emerald-50 text-emerald-700'},
        ],
        toggleChannelSev(ch,s){const i=ch.severities.indexOf(s);if(i>=0){if(ch.severities.length>1)ch.severities.splice(i,1)}else ch.severities.push(s)},
        init(){this.$nextTick(()=>lucide.createIcons())}
    }
}
</script>
</body>
</html>
