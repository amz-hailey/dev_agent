<!DOCTYPE html>
<html lang="ko" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenOS ‚Äî ÏõåÌÅ¨ÌîåÎ°úÏö∞ ÎπåÎçî</title>
    <link rel="stylesheet" href="cdn/tailwind.css">
    <script defer src="cdn/alpine.js"></script>
    <script src="cdn/lucide.js"></script>
                    
    <style>
        .scrollbar-thin::-webkit-scrollbar { width: 4px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: transparent; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 2px; }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
        .canvas-grid { background-image: radial-gradient(circle, #cbd5e1 1px, transparent 1px); background-size: 24px 24px; }
        .palette-node { cursor: grab; }
        .palette-node:active { cursor: grabbing; }
        @keyframes slideDown { from { opacity:0; transform:translateY(-8px); } to { opacity:1; transform:translateY(0); } }
        .slide-down { animation: slideDown 0.2s ease-out; }
    </style>
</head>
<body class="h-full bg-slate-50 font-sans antialiased">

<div x-data="workflowBuilder()" x-init="init()" class="flex h-full">

    <!-- ==================== SIDEBAR ==================== -->
    <aside class="w-[240px] bg-white border-r border-slate-200 flex flex-col flex-shrink-0 h-screen sticky top-0">
        <div class="h-16 flex items-center gap-2.5 px-5 border-b border-slate-100">
            <div class="w-8 h-8 rounded-lg bg-slate-900 flex items-center justify-center">
                <i data-lucide="shield-check" class="w-5 h-5 text-white"></i>
            </div>
            <span class="text-lg font-bold text-slate-900 tracking-tight">GenOS</span>
        </div>
        <nav class="flex-1 overflow-y-auto scrollbar-thin py-4 px-3">
            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider px-2 mb-1.5">Î≥¥Ïïà Ïö¥ÏòÅ</p>
            <a href="PG-02_dashboard.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="layout-dashboard" class="w-4 h-4"></i> Î©îÏù∏ ÎåÄÏãúÎ≥¥Îìú</a>
            <a href="PG-06_realtime_monitoring.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="activity" class="w-4 h-4"></i> Ïã§ÏãúÍ∞Ñ Î™®ÎãàÌÑ∞ÎßÅ</a>
            <a href="PG-07_alert_management.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="bell" class="w-4 h-4"></i> ÏïåÎ¶º Í¥ÄÎ¶¨
                <span class="ml-auto text-[11px] bg-red-100 text-red-700 font-medium px-1.5 py-0.5 rounded-full">3</span></a>

            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider px-2 mb-1.5 mt-5">ÏóêÏù¥Ï†ÑÌä∏ Í¥ÄÎ¶¨</p>
            <a href="PG-03_agent_templates.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="boxes" class="w-4 h-4"></i> ÌÖúÌîåÎ¶ø ÎùºÏù¥Î∏åÎü¨Î¶¨</a>
            <a href="PG-04_deploy_wizard.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="rocket" class="w-4 h-4"></i> Î∞∞Ìè¨ ÏúÑÏ†ÄÎìú</a>
            <a href="PG-05_connector_hub.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="plug" class="w-4 h-4"></i> Ïª§ÎÑ•ÌÑ∞ ÌóàÎ∏å</a>

            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider px-2 mb-1.5 mt-5">ÏûêÎèôÌôî</p>
            <a href="PG-13_workflow_builder.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm font-medium bg-slate-100 text-slate-900 mb-0.5">
                <i data-lucide="git-branch" class="w-4 h-4"></i> ÏõåÌÅ¨ÌîåÎ°úÏö∞ ÎπåÎçî</a>

            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider px-2 mb-1.5 mt-5">Î¶¨Ìè¨ÌåÖ ¬∑ Í∞êÏÇ¨</p>
            <a href="PG-08_compliance_reports.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="file-text" class="w-4 h-4"></i> Ïª¥ÌîåÎùºÏù¥Ïñ∏Ïä§ Î¶¨Ìè¨Ìä∏</a>
            <a href="PG-09_audit_log.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="scroll-text" class="w-4 h-4"></i> Í∞êÏÇ¨ Î°úÍ∑∏</a>

            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider px-2 mb-1.5 mt-5">ÏãúÏä§ÌÖú Í¥ÄÎ¶¨</p>
            <a href="PG-10_user_permissions.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="users" class="w-4 h-4"></i> ÏÇ¨Ïö©Ïûê/Í∂åÌïú</a>
            <a href="PG-11_system_dr.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="server" class="w-4 h-4"></i> ÏãúÏä§ÌÖú/DR</a>
            <a href="PG-12_settings.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="settings" class="w-4 h-4"></i> ÏÑ§Ï†ï</a>

            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider px-2 mb-1.5 mt-5">ÎÇ¥Î∂Ä Í¥ÄÎ¶¨</p>
            <a href="PG-14_customer_health.html" class="flex items-center gap-2.5 px-2.5 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors mb-0.5">
                <i data-lucide="heart-pulse" class="w-4 h-4"></i> Í≥†Í∞ù Health</a>
        </nav>
        <div class="border-t border-slate-100 p-3">
            <div class="flex items-center gap-2.5 px-2 py-1.5">
                <div class="w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-xs font-bold text-slate-600">ÍπÄ</div>
                <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium text-slate-900 truncate">ÍπÄÎ∂ÄÏû•</p>
                    <p class="text-[11px] text-slate-400 truncate">IT Î≥¥ÏïàÌåÄ</p>
                </div>
                <button class="text-slate-400 hover:text-slate-600 transition-colors"><i data-lucide="log-out" class="w-4 h-4"></i></button>
            </div>
        </div>
    </aside>

    <!-- ==================== MAIN ==================== -->
    <main class="flex-1 flex flex-col min-w-0 h-screen">

        <!-- Toolbar -->
        <div class="h-14 bg-white border-b border-slate-200 flex items-center justify-between px-4 flex-shrink-0">
            <div class="flex items-center gap-3">
                <div class="flex items-center gap-2">
                    <h1 class="text-sm font-bold text-slate-900">Ïù¥ÏÉÅÍ±∞Îûò ÌÉêÏßÄ ÏûêÎèôÌôî</h1>
                    <button class="text-slate-400 hover:text-slate-600"><i data-lucide="pencil" class="w-3.5 h-3.5"></i></button>
                </div>
                <span class="text-[11px] font-medium px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-700">v2.1 Î∞∞Ìè¨Îê®</span>
                <span class="text-[11px] text-slate-400">ÎßàÏßÄÎßâ Ï†ÄÏû•: 14:32</span>
            </div>
            <div class="flex items-center gap-1">
                <button class="p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-50 rounded-md transition-colors" title="Ïã§Ìñâ Ï∑®ÏÜå">
                    <i data-lucide="undo-2" class="w-4 h-4"></i></button>
                <button class="p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-50 rounded-md transition-colors" title="Îã§Ïãú Ïã§Ìñâ">
                    <i data-lucide="redo-2" class="w-4 h-4"></i></button>
                <div class="w-px h-5 bg-slate-200 mx-1"></div>
                <button @click="zoom = Math.max(50, zoom-10)" class="p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-50 rounded transition-colors">
                    <i data-lucide="minus" class="w-3.5 h-3.5"></i></button>
                <span class="text-xs text-slate-500 w-10 text-center" x-text="zoom+'%'"></span>
                <button @click="zoom = Math.min(150, zoom+10)" class="p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-50 rounded transition-colors">
                    <i data-lucide="plus" class="w-3.5 h-3.5"></i></button>
                <div class="w-px h-5 bg-slate-200 mx-1"></div>
                <button class="p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-50 rounded-md transition-colors" title="ÏûêÎèô Ï†ïÎ†¨">
                    <i data-lucide="align-horizontal-distribute-center" class="w-4 h-4"></i></button>
                <div class="w-px h-5 bg-slate-200 mx-1"></div>
                <button class="h-8 px-3 rounded-md border border-slate-200 text-xs font-medium text-slate-600 hover:bg-slate-50 transition-colors inline-flex items-center gap-1.5">
                    <i data-lucide="check-circle" class="w-3.5 h-3.5"></i> Í≤ÄÏ¶ù</button>
                <button class="h-8 px-3 rounded-md border border-slate-200 text-xs font-medium text-slate-600 hover:bg-slate-50 transition-colors inline-flex items-center gap-1.5">
                    <i data-lucide="play" class="w-3.5 h-3.5"></i> ÌÖåÏä§Ìä∏</button>
                <button class="h-8 px-3 rounded-md bg-slate-900 text-xs font-medium text-white hover:bg-slate-800 transition-colors inline-flex items-center gap-1.5">
                    <i data-lucide="rocket" class="w-3.5 h-3.5"></i> Î∞∞Ìè¨</button>
            </div>
        </div>

        <!-- Builder Area -->
        <div class="flex-1 flex flex-col min-h-0">
            <div class="flex-1 flex min-h-0">

                <!-- ==================== NODE PALETTE ==================== -->
                <div class="w-[240px] bg-white border-r border-slate-200 flex flex-col flex-shrink-0">
                    <div class="p-3 border-b border-slate-100">
                        <div class="relative">
                            <i data-lucide="search" class="absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400"></i>
                            <input x-model="paletteSearch" type="text" placeholder="ÎÖ∏Îìú Í≤ÄÏÉâ..."
                                   class="w-full h-8 pl-8 pr-3 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300 focus:border-blue-300">
                        </div>
                    </div>
                    <div class="flex-1 overflow-y-auto scrollbar-thin p-2">
                        <template x-for="cat in filteredCategories" :key="cat.id">
                            <div class="mb-1">
                                <button @click="toggleCategory(cat.id)"
                                        class="w-full flex items-center justify-between px-2 py-1.5 rounded-md text-xs font-semibold text-slate-600 hover:bg-slate-50 transition-colors">
                                    <div class="flex items-center gap-2">
                                        <span class="w-2 h-2 rounded-full" :class="'bg-'+cat.color+'-500'"></span>
                                        <span x-text="cat.label"></span>
                                        <span class="text-slate-400 font-normal" x-text="'('+cat.nodes.length+')'"></span>
                                    </div>
                                    <i data-lucide="chevron-down" class="w-3.5 h-3.5 text-slate-400 transition-transform" :class="isCategoryOpen(cat.id) ? '' : '-rotate-90'"></i>
                                </button>
                                <div x-show="isCategoryOpen(cat.id)" x-transition.duration.150ms class="mt-0.5 space-y-0.5">
                                    <template x-for="node in cat.nodes" :key="node.id">
                                        <div class="palette-node flex items-center gap-2.5 px-2.5 py-2 rounded-md border border-transparent hover:border-slate-200 hover:bg-slate-50 transition-colors group">
                                            <div class="w-7 h-7 rounded-md flex items-center justify-center flex-shrink-0" :class="'bg-'+cat.color+'-50'">
                                                <i :data-lucide="node.icon" class="w-3.5 h-3.5" :class="'text-'+cat.color+'-600'"></i>
                                            </div>
                                            <div class="min-w-0 flex-1">
                                                <p class="text-xs font-medium text-slate-700 truncate" x-text="node.label"></p>
                                                <p class="text-[10px] text-slate-400 truncate" x-text="node.desc"></p>
                                            </div>
                                            <i data-lucide="grip-vertical" class="w-3 h-3 text-slate-300 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"></i>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- ==================== CANVAS ==================== -->
                <div class="flex-1 bg-slate-100 canvas-grid overflow-auto relative">
                    <div class="relative" style="width: 1480px; height: 440px; min-width: 100%; min-height: 100%;">

                        <!-- SVG Edges -->
                        <svg class="absolute inset-0 pointer-events-none" width="1480" height="440">
                            <defs>
                                <marker id="arr-g" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto"><path d="M0 0L8 4L0 8z" fill="#22c55e"/></marker>
                                <marker id="arr-a" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto"><path d="M0 0L8 4L0 8z" fill="#f59e0b"/></marker>
                            </defs>
                            <!-- n1‚Üín2 -->
                            <path d="M210 208 C245 208,245 208,280 208" stroke="#22c55e" stroke-width="2" fill="none" marker-end="url(#arr-g)"/>
                            <!-- n2‚Üín3 -->
                            <path d="M450 208 C485 208,485 208,520 208" stroke="#22c55e" stroke-width="2" fill="none" marker-end="url(#arr-g)"/>
                            <!-- n3‚Üín4 (conditional) -->
                            <path d="M690 208 C730 178,720 118,760 108" stroke="#f59e0b" stroke-width="2" stroke-dasharray="6 3" fill="none" marker-end="url(#arr-a)"/>
                            <text x="718" y="152" class="text-[10px] fill-amber-600 font-medium">Í≥†ÏúÑÌóò ‚â•85</text>
                            <!-- n3‚Üín5 (conditional) -->
                            <path d="M690 208 C730 238,720 298,760 308" stroke="#f59e0b" stroke-width="2" stroke-dasharray="6 3" fill="none" marker-end="url(#arr-a)"/>
                            <text x="718" y="278" class="text-[10px] fill-amber-600 font-medium">Ï§ëÏúÑÌóò &lt;85</text>
                            <!-- n4‚Üín6 -->
                            <path d="M930 108 C965 108,965 108,1000 108" stroke="#22c55e" stroke-width="2" fill="none" marker-end="url(#arr-g)"/>
                            <!-- n5‚Üín7 -->
                            <path d="M930 308 C965 308,965 308,1000 308" stroke="#22c55e" stroke-width="2" fill="none" marker-end="url(#arr-g)"/>
                            <!-- n6‚Üín8 -->
                            <path d="M1170 108 C1210 108,1200 208,1240 208" stroke="#22c55e" stroke-width="2" fill="none" marker-end="url(#arr-g)"/>
                            <!-- n7‚Üín8 -->
                            <path d="M1170 308 C1210 308,1200 208,1240 208" stroke="#22c55e" stroke-width="2" fill="none" marker-end="url(#arr-g)"/>
                        </svg>

                        <!-- Node Cards -->
                        <!-- N1: Ïù¥ÏÉÅÍ±∞Îûò ÌÉêÏßÄ -->
                        <div class="absolute w-[170px] rounded-lg border-2 bg-white shadow-sm cursor-pointer transition-all hover:shadow"
                             :class="selectedNode==='n1' ? 'border-blue-400 shadow-md ring-2 ring-blue-100' : 'border-slate-200 hover:border-slate-300'"
                             style="left:40px;top:180px" @click="selectNode('n1')">
                            <div class="flex items-center gap-2.5 px-3 py-2.5">
                                <div class="w-8 h-8 rounded-md bg-blue-50 flex items-center justify-center flex-shrink-0">
                                    <i data-lucide="shield" class="w-4 h-4 text-blue-600"></i></div>
                                <div class="min-w-0"><p class="text-xs font-semibold text-slate-800 truncate">Ïù¥ÏÉÅÍ±∞Îûò ÌÉêÏßÄ</p>
                                    <p class="text-[10px] text-slate-400">FDS v2.1</p></div>
                            </div>
                            <div class="absolute -right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-emerald-400"></div>
                        </div>

                        <!-- N2: ÏúÑÌóòÎèÑ Î∂ÑÎ•ò -->
                        <div class="absolute w-[170px] rounded-lg border-2 bg-white shadow-sm cursor-pointer transition-all hover:shadow"
                             :class="selectedNode==='n2' ? 'border-blue-400 shadow-md ring-2 ring-blue-100' : 'border-slate-200 hover:border-slate-300'"
                             style="left:280px;top:180px" @click="selectNode('n2')">
                            <div class="flex items-center gap-2.5 px-3 py-2.5">
                                <div class="w-8 h-8 rounded-md bg-indigo-50 flex items-center justify-center flex-shrink-0">
                                    <i data-lucide="bar-chart-3" class="w-4 h-4 text-indigo-600"></i></div>
                                <div class="min-w-0"><p class="text-xs font-semibold text-slate-800 truncate">ÏúÑÌóòÎèÑ Î∂ÑÎ•ò</p>
                                    <p class="text-[10px] text-slate-400">3Îì±Í∏â Î∂ÑÎ•ò</p></div>
                            </div>
                            <div class="absolute -left-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-emerald-400"></div>
                            <div class="absolute -right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-emerald-400"></div>
                        </div>

                        <!-- N3: ÏûÑÍ≥ÑÍ∞í Î∂ÑÍ∏∞ -->
                        <div class="absolute w-[170px] rounded-lg border-2 bg-white shadow-sm cursor-pointer transition-all hover:shadow"
                             :class="selectedNode==='n3' ? 'border-blue-400 shadow-md ring-2 ring-blue-100' : 'border-slate-200 hover:border-slate-300'"
                             style="left:520px;top:180px" @click="selectNode('n3')">
                            <div class="flex items-center gap-2.5 px-3 py-2.5">
                                <div class="w-8 h-8 rounded-md bg-amber-50 flex items-center justify-center flex-shrink-0">
                                    <i data-lucide="git-branch" class="w-4 h-4 text-amber-600"></i></div>
                                <div class="min-w-0"><p class="text-xs font-semibold text-slate-800 truncate">ÏûÑÍ≥ÑÍ∞í Î∂ÑÍ∏∞</p>
                                    <p class="text-[10px] text-slate-400">risk_score ‚â• 85</p></div>
                            </div>
                            <div class="absolute -left-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-emerald-400"></div>
                            <div class="absolute -right-1.5 top-1/3 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-amber-400"></div>
                            <div class="absolute -right-1.5 top-2/3 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-amber-400"></div>
                        </div>

                        <!-- N4: ÏûêÎèô Ï∞®Îã® -->
                        <div class="absolute w-[170px] rounded-lg border-2 bg-white shadow-sm cursor-pointer transition-all hover:shadow"
                             :class="selectedNode==='n4' ? 'border-blue-400 shadow-md ring-2 ring-blue-100' : 'border-slate-200 hover:border-slate-300'"
                             style="left:760px;top:80px" @click="selectNode('n4')">
                            <div class="flex items-center gap-2.5 px-3 py-2.5">
                                <div class="w-8 h-8 rounded-md bg-red-50 flex items-center justify-center flex-shrink-0">
                                    <i data-lucide="ban" class="w-4 h-4 text-red-600"></i></div>
                                <div class="min-w-0"><p class="text-xs font-semibold text-slate-800 truncate">ÏûêÎèô Ï∞®Îã®</p>
                                    <p class="text-[10px] text-slate-400">ÏûÑÍ≥ÑÍ∞í 90</p></div>
                            </div>
                            <div class="absolute -left-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-amber-400"></div>
                            <div class="absolute -right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-emerald-400"></div>
                        </div>

                        <!-- N5: ÏàòÎèô Í≤ÄÌÜ† ÎåÄÍ∏∞ -->
                        <div class="absolute w-[170px] rounded-lg border-2 bg-white shadow-sm cursor-pointer transition-all hover:shadow"
                             :class="selectedNode==='n5' ? 'border-blue-400 shadow-md ring-2 ring-blue-100' : 'border-slate-200 hover:border-slate-300'"
                             style="left:760px;top:280px" @click="selectNode('n5')">
                            <div class="flex items-center gap-2.5 px-3 py-2.5">
                                <div class="w-8 h-8 rounded-md bg-red-50 flex items-center justify-center flex-shrink-0">
                                    <i data-lucide="eye" class="w-4 h-4 text-red-600"></i></div>
                                <div class="min-w-0"><p class="text-xs font-semibold text-slate-800 truncate">ÏàòÎèô Í≤ÄÌÜ† ÎåÄÍ∏∞</p>
                                    <p class="text-[10px] text-slate-400">Í≤ÄÌÜ† ÎåÄÍ∏∞Ïó¥</p></div>
                            </div>
                            <div class="absolute -left-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-amber-400"></div>
                            <div class="absolute -right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-emerald-400"></div>
                        </div>

                        <!-- N6: Slack ÏïåÎ¶º -->
                        <div class="absolute w-[170px] rounded-lg border-2 bg-white shadow-sm cursor-pointer transition-all hover:shadow"
                             :class="selectedNode==='n6' ? 'border-blue-400 shadow-md ring-2 ring-blue-100' : 'border-slate-200 hover:border-slate-300'"
                             style="left:1000px;top:80px" @click="selectNode('n6')">
                            <div class="flex items-center gap-2.5 px-3 py-2.5">
                                <div class="w-8 h-8 rounded-md bg-emerald-50 flex items-center justify-center flex-shrink-0">
                                    <i data-lucide="message-square" class="w-4 h-4 text-emerald-600"></i></div>
                                <div class="min-w-0"><p class="text-xs font-semibold text-slate-800 truncate">Slack ÏïåÎ¶º</p>
                                    <p class="text-[10px] text-slate-400">#security-alerts</p></div>
                            </div>
                            <div class="absolute -left-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-emerald-400"></div>
                            <div class="absolute -right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-emerald-400"></div>
                        </div>

                        <!-- N7: Ïù¥Î©îÏùº ÏïåÎ¶º -->
                        <div class="absolute w-[170px] rounded-lg border-2 bg-white shadow-sm cursor-pointer transition-all hover:shadow"
                             :class="selectedNode==='n7' ? 'border-blue-400 shadow-md ring-2 ring-blue-100' : 'border-slate-200 hover:border-slate-300'"
                             style="left:1000px;top:280px" @click="selectNode('n7')">
                            <div class="flex items-center gap-2.5 px-3 py-2.5">
                                <div class="w-8 h-8 rounded-md bg-emerald-50 flex items-center justify-center flex-shrink-0">
                                    <i data-lucide="mail" class="w-4 h-4 text-emerald-600"></i></div>
                                <div class="min-w-0"><p class="text-xs font-semibold text-slate-800 truncate">Ïù¥Î©îÏùº ÏïåÎ¶º</p>
                                    <p class="text-[10px] text-slate-400">security@company</p></div>
                            </div>
                            <div class="absolute -left-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-emerald-400"></div>
                            <div class="absolute -right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-emerald-400"></div>
                        </div>

                        <!-- N8: Ïù∏ÏãúÎçòÌä∏ Î¶¨Ìè¨Ìä∏ -->
                        <div class="absolute w-[170px] rounded-lg border-2 bg-white shadow-sm cursor-pointer transition-all hover:shadow"
                             :class="selectedNode==='n8' ? 'border-blue-400 shadow-md ring-2 ring-blue-100' : 'border-slate-200 hover:border-slate-300'"
                             style="left:1240px;top:180px" @click="selectNode('n8')">
                            <div class="flex items-center gap-2.5 px-3 py-2.5">
                                <div class="w-8 h-8 rounded-md bg-violet-50 flex items-center justify-center flex-shrink-0">
                                    <i data-lucide="file-text" class="w-4 h-4 text-violet-600"></i></div>
                                <div class="min-w-0"><p class="text-xs font-semibold text-slate-800 truncate">Ïù∏ÏãúÎçòÌä∏ Î¶¨Ìè¨Ìä∏</p>
                                    <p class="text-[10px] text-slate-400">ÏûêÎèô ÏÉùÏÑ±</p></div>
                            </div>
                            <div class="absolute -left-1.5 top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-white border-2 border-emerald-400"></div>
                        </div>

                        <!-- Minimap -->
                        <div class="absolute bottom-3 right-3 w-[140px] h-[80px] bg-white/90 border border-slate-200 rounded-lg overflow-hidden backdrop-blur-sm shadow-sm">
                            <svg width="100%" height="100%" viewBox="0 0 1480 440" preserveAspectRatio="xMidYMid meet" class="p-1">
                                <rect x="40" y="180" width="170" height="56" rx="4" fill="#dbeafe" stroke="#93c5fd" stroke-width="3"/>
                                <rect x="280" y="180" width="170" height="56" rx="4" fill="#e0e7ff" stroke="#a5b4fc" stroke-width="3"/>
                                <rect x="520" y="180" width="170" height="56" rx="4" fill="#fef3c7" stroke="#fcd34d" stroke-width="3"/>
                                <rect x="760" y="80" width="170" height="56" rx="4" fill="#fee2e2" stroke="#fca5a5" stroke-width="3"/>
                                <rect x="760" y="280" width="170" height="56" rx="4" fill="#fee2e2" stroke="#fca5a5" stroke-width="3"/>
                                <rect x="1000" y="80" width="170" height="56" rx="4" fill="#d1fae5" stroke="#6ee7b7" stroke-width="3"/>
                                <rect x="1000" y="280" width="170" height="56" rx="4" fill="#d1fae5" stroke="#6ee7b7" stroke-width="3"/>
                                <rect x="1240" y="180" width="170" height="56" rx="4" fill="#ede9fe" stroke="#c4b5fd" stroke-width="3"/>
                                <path d="M210 208 L280 208" stroke="#94a3b8" stroke-width="3" fill="none"/>
                                <path d="M450 208 L520 208" stroke="#94a3b8" stroke-width="3" fill="none"/>
                                <path d="M690 208 Q725 108 760 108" stroke="#94a3b8" stroke-width="3" fill="none"/>
                                <path d="M690 208 Q725 308 760 308" stroke="#94a3b8" stroke-width="3" fill="none"/>
                                <path d="M930 108 L1000 108" stroke="#94a3b8" stroke-width="3" fill="none"/>
                                <path d="M930 308 L1000 308" stroke="#94a3b8" stroke-width="3" fill="none"/>
                                <path d="M1170 108 Q1205 208 1240 208" stroke="#94a3b8" stroke-width="3" fill="none"/>
                                <path d="M1170 308 Q1205 208 1240 208" stroke="#94a3b8" stroke-width="3" fill="none"/>
                            </svg>
                        </div>
                    </div>
                </div>

                <!-- ==================== PROPERTY PANEL ==================== -->
                <div class="w-[300px] bg-white border-l border-slate-200 flex flex-col flex-shrink-0">
                    <!-- Panel Header -->
                    <div class="h-11 flex items-center justify-between px-4 border-b border-slate-100">
                        <span class="text-xs font-semibold text-slate-700">ÎÖ∏Îìú ÏÜçÏÑ±</span>
                        <div class="flex items-center gap-1">
                            <button class="p-1 text-slate-400 hover:text-slate-600 rounded" title="Î≥µÏ†ú"><i data-lucide="copy" class="w-3.5 h-3.5"></i></button>
                            <button class="p-1 text-red-400 hover:text-red-600 rounded" title="ÏÇ≠Ï†ú"><i data-lucide="trash-2" class="w-3.5 h-3.5"></i></button>
                        </div>
                    </div>

                    <!-- Panel Content -->
                    <div class="flex-1 overflow-y-auto scrollbar-thin p-4 space-y-4" x-show="selectedNode">

                        <!-- Basic Info (shared) -->
                        <div>
                            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider mb-2">Í∏∞Î≥∏ Ï†ïÎ≥¥</p>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">ÎÖ∏Îìú Ïù¥Î¶Ñ</label>
                                    <input type="text" :value="nodeInfo[selectedNode]?.label"
                                           class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                </div>
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">ÏÑ§Î™Ö</label>
                                    <textarea :value="nodeInfo[selectedNode]?.desc" rows="2"
                                              class="w-full px-2.5 py-1.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300 resize-none"></textarea>
                                </div>
                                <div class="flex items-center justify-between">
                                    <label class="text-xs text-slate-500">ÌôúÏÑ±Ìôî</label>
                                    <button class="w-9 h-5 rounded-full bg-emerald-500 relative transition-colors">
                                        <span class="absolute right-0.5 top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-transform"></span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="border-t border-slate-100"></div>

                        <!-- Detection Settings -->
                        <div x-show="nodeInfo[selectedNode]?.type==='detection'" x-transition>
                            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider mb-2">ÌÉêÏßÄ ÏÑ§Ï†ï</p>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">ÌÉêÏßÄ Î™®Îç∏</label>
                                    <select class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                        <option selected>FDS v2.1</option><option>AML v1.3</option><option>ÎÇ¥Î∂ÄÏú†Ï∂ú v1.0</option><option>Ï†ëÍ∑ºÍ∂åÌïú v1.0</option>
                                    </select>
                                </div>
                                <div>
                                    <div class="flex items-center justify-between mb-1">
                                        <label class="text-xs text-slate-500">ÌÉêÏßÄ ÎØºÍ∞êÎèÑ</label>
                                        <span class="text-xs font-medium text-slate-700">75</span>
                                    </div>
                                    <input type="range" min="1" max="100" value="75" class="w-full h-1.5 bg-slate-200 rounded-full appearance-none cursor-pointer accent-blue-600">
                                </div>
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">Ïã†Î¢∞ÎèÑ ÏûÑÍ≥ÑÍ∞í (%)</label>
                                    <input type="number" value="85" min="50" max="99"
                                           class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                </div>
                            </div>
                        </div>

                        <!-- Classification Settings -->
                        <div x-show="nodeInfo[selectedNode]?.type==='classification'" x-transition>
                            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider mb-2">Î∂ÑÎ•ò ÏÑ§Ï†ï</p>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-xs text-slate-500 mb-1.5 block">ÏúÑÌóò Îì±Í∏â</label>
                                    <div class="space-y-1.5">
                                        <label class="flex items-center gap-2 text-xs text-slate-700">
                                            <input type="checkbox" checked class="rounded border-slate-300 text-blue-600 focus:ring-blue-300"> Í≥†ÏúÑÌóò</label>
                                        <label class="flex items-center gap-2 text-xs text-slate-700">
                                            <input type="checkbox" checked class="rounded border-slate-300 text-blue-600 focus:ring-blue-300"> Ï§ëÏúÑÌóò</label>
                                        <label class="flex items-center gap-2 text-xs text-slate-700">
                                            <input type="checkbox" checked class="rounded border-slate-300 text-blue-600 focus:ring-blue-300"> Ï†ÄÏúÑÌóò</label>
                                    </div>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">Í≥†ÏúÑÌóò ÏûÑÍ≥ÑÍ∞í (Ï†êÏàò)</label>
                                    <input type="number" value="85" min="0" max="100"
                                           class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                </div>
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">Ï§ëÏúÑÌóò ÏûÑÍ≥ÑÍ∞í (Ï†êÏàò)</label>
                                    <input type="number" value="60" min="0" max="100"
                                           class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                </div>
                            </div>
                        </div>

                        <!-- Condition Settings -->
                        <div x-show="nodeInfo[selectedNode]?.type==='condition'" x-transition>
                            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider mb-2">Ï°∞Í±¥ Î∂ÑÍ∏∞ ÏÑ§Ï†ï</p>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">Ï°∞Í±¥ ÌïÑÎìú</label>
                                    <select class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                        <option selected>risk_score</option><option>amount</option><option>frequency</option><option>time_of_day</option><option>geo_location</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">Ïó∞ÏÇ∞Ïûê</label>
                                    <select class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                        <option>></option><option selected>>=</option><option>&lt;</option><option>&lt;=</option><option>==</option><option>!=</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">Ï°∞Í±¥ Í∞í</label>
                                    <input type="text" value="85"
                                           class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                </div>
                            </div>
                        </div>

                        <!-- Response Settings (auto_block) -->
                        <div x-show="nodeInfo[selectedNode]?.type==='response'" x-transition>
                            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider mb-2">ÎåÄÏùë ÏÑ§Ï†ï</p>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between">
                                    <label class="text-xs text-slate-500">ÏûêÎèô Ï∞®Îã® ÌôúÏÑ±Ìôî</label>
                                    <button class="w-9 h-5 rounded-full relative transition-colors"
                                            :class="selectedNode==='n4' ? 'bg-emerald-500' : 'bg-slate-300'">
                                        <span class="absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-transform"
                                              :class="selectedNode==='n4' ? 'right-0.5' : 'left-0.5'"></span>
                                    </button>
                                </div>
                                <div x-show="selectedNode==='n4'">
                                    <label class="text-xs text-slate-500 mb-1 block">Ï∞®Îã® ÏûÑÍ≥ÑÍ∞í (ÏúÑÌóò Ï†êÏàò)</label>
                                    <input type="number" value="90" min="80" max="100"
                                           class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                </div>
                                <div x-show="selectedNode==='n4'">
                                    <label class="text-xs text-slate-500 mb-1 block">Ï∞®Îã® ÏßÄÏÜç ÏãúÍ∞Ñ (Î∂Ñ)</label>
                                    <input type="number" value="30" min="1" max="1440"
                                           class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                </div>
                                <div class="flex items-center justify-between" x-show="selectedNode==='n4'">
                                    <label class="text-xs text-slate-500">ÏàòÎèô Ìï¥Ï†ú ÌïÑÏöî</label>
                                    <button class="w-9 h-5 rounded-full bg-emerald-500 relative"><span class="absolute right-0.5 top-0.5 w-4 h-4 rounded-full bg-white shadow-sm"></span></button>
                                </div>
                                <div class="flex items-center justify-between" x-show="selectedNode==='n4'">
                                    <label class="text-xs text-slate-500">Ï∞®Îã® Ïãú ÏïåÎ¶º Î∞úÏÜ°</label>
                                    <button class="w-9 h-5 rounded-full bg-emerald-500 relative"><span class="absolute right-0.5 top-0.5 w-4 h-4 rounded-full bg-white shadow-sm"></span></button>
                                </div>
                            </div>
                        </div>

                        <!-- Notification Settings -->
                        <div x-show="nodeInfo[selectedNode]?.type==='notification'" x-transition>
                            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider mb-2">ÏïåÎ¶º ÏÑ§Ï†ï</p>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">ÏïåÎ¶º Ï±ÑÎÑê</label>
                                    <select class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                        <option :selected="selectedNode==='n6'">Slack</option>
                                        <option :selected="selectedNode==='n7'">Email</option>
                                        <option>SMS</option><option>Microsoft Teams</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">ÏàòÏã†Ïûê</label>
                                    <div class="flex flex-wrap gap-1 p-1.5 bg-slate-50 border border-slate-200 rounded-md min-h-[32px]">
                                        <span class="inline-flex items-center gap-1 text-[11px] bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded"
                                              x-text="selectedNode==='n6' ? '#security-alerts' : 'security@company.com'">
                                        </span>
                                    </div>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">Î©îÏãúÏßÄ ÌÖúÌîåÎ¶ø</label>
                                    <textarea rows="3" class="w-full px-2.5 py-1.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300 resize-none"
                                              x-text="selectedNode==='n6' ? 'üö® [Í≥†ÏúÑÌóò] Ïù¥ÏÉÅÍ±∞Îûò Í∞êÏßÄ\nÍ±∞ÎûòID: {{tx_id}}\nÏúÑÌóòÏ†êÏàò: {{risk_score}}' : '[Ï§ëÏúÑÌóò Í±∞Îûò] ÏàòÎèô Í≤ÄÌÜ† ÌïÑÏöî\nÍ±∞ÎûòID: {{tx_id}}'"></textarea>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">ÏïåÎ¶º Ïø®Îã§Ïö¥ (Î∂Ñ)</label>
                                    <input type="number" :value="selectedNode==='n6' ? 5 : 10" min="0" max="60"
                                           class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                </div>
                            </div>
                        </div>

                        <!-- Report Settings -->
                        <div x-show="nodeInfo[selectedNode]?.type==='report'" x-transition>
                            <p class="text-[11px] font-semibold text-slate-400 uppercase tracking-wider mb-2">Î¶¨Ìè¨Ìä∏ ÏÑ§Ï†ï</p>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">Î¶¨Ìè¨Ìä∏ ÌòïÏãù</label>
                                    <select class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                        <option selected>Ïù∏ÏãúÎçòÌä∏ Î≥¥Í≥†ÏÑú</option><option>Ïª¥ÌîåÎùºÏù¥Ïñ∏Ïä§ Î°úÍ∑∏</option><option>ÏöîÏïΩ Î¶¨Ìè¨Ìä∏</option>
                                    </select>
                                </div>
                                <div class="flex items-center justify-between">
                                    <label class="text-xs text-slate-500">ÏûêÎèô Î∞úÏÜ°</label>
                                    <button class="w-9 h-5 rounded-full bg-emerald-500 relative"><span class="absolute right-0.5 top-0.5 w-4 h-4 rounded-full bg-white shadow-sm"></span></button>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">Î≥¥Í¥Ä Í∏∞Í∞Ñ</label>
                                    <select class="w-full h-8 px-2.5 text-xs bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-300">
                                        <option>1ÎÖÑ</option><option selected>3ÎÖÑ</option><option>5ÎÖÑ</option><option>ÏòÅÍµ¨</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- No selection state -->
                        <div x-show="!selectedNode" class="flex flex-col items-center justify-center h-full text-center px-6">
                            <i data-lucide="mouse-pointer-click" class="w-8 h-8 text-slate-300 mb-3"></i>
                            <p class="text-xs text-slate-400">Ï∫îÎ≤ÑÏä§ÏóêÏÑú ÎÖ∏ÎìúÎ•º ÏÑ†ÌÉùÌïòÎ©¥<br>Ïó¨Í∏∞Ïóê ÏÜçÏÑ±Ïù¥ ÌëúÏãúÎê©ÎãàÎã§.</p>
                        </div>

                        <!-- Action Buttons -->
                        <div class="border-t border-slate-100 pt-3 mt-auto">
                            <div class="grid grid-cols-2 gap-2">
                                <button class="h-8 text-xs font-medium text-slate-600 border border-slate-200 rounded-md hover:bg-slate-50 transition-colors">Ï¥àÍ∏∞Ìôî</button>
                                <button class="h-8 text-xs font-medium text-white bg-slate-900 rounded-md hover:bg-slate-800 transition-colors">Ï†ÄÏû•</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ==================== VERSION HISTORY DRAWER ==================== -->
            <div class="border-t border-slate-200 bg-white flex-shrink-0">
                <button @click="showVersions=!showVersions" class="w-full h-9 flex items-center justify-center gap-1.5 text-xs text-slate-500 hover:bg-slate-50 transition-colors">
                    <i data-lucide="history" class="w-3.5 h-3.5"></i>
                    <span>Î≤ÑÏ†Ñ Ïù¥Î†• (5)</span>
                    <i data-lucide="chevron-up" class="w-3 h-3 transition-transform" :class="showVersions ? 'rotate-180' : ''"></i>
                </button>
                <div x-show="showVersions" x-transition.duration.200ms class="border-t border-slate-100">
                    <div class="max-h-[200px] overflow-auto px-4 pb-3">
                        <table class="w-full text-xs">
                            <thead class="sticky top-0 bg-white">
                                <tr class="text-left text-slate-400 font-medium border-b border-slate-100">
                                    <th class="py-2 pr-3 w-16">Î≤ÑÏ†Ñ</th>
                                    <th class="py-2 pr-3 w-36">Î≥ÄÍ≤Ω ÏùºÏãú</th>
                                    <th class="py-2 pr-3 w-16">Î≥ÄÍ≤ΩÏûê</th>
                                    <th class="py-2 pr-3">Î≥ÄÍ≤Ω ÏöîÏïΩ</th>
                                    <th class="py-2 pr-3 w-20">ÏÉÅÌÉú</th>
                                    <th class="py-2 pr-3 w-14">ÎÖ∏Îìú</th>
                                    <th class="py-2 w-24 text-right">Ïï°ÏÖò</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="v in versions" :key="v.version">
                                    <tr class="border-b border-slate-50 hover:bg-slate-50 transition-colors">
                                        <td class="py-2 pr-3 font-medium text-slate-700" x-text="v.version"></td>
                                        <td class="py-2 pr-3 text-slate-500" x-text="v.date"></td>
                                        <td class="py-2 pr-3 text-slate-600" x-text="v.author"></td>
                                        <td class="py-2 pr-3 text-slate-600" x-text="v.summary"></td>
                                        <td class="py-2 pr-3">
                                            <span class="text-[10px] font-medium px-1.5 py-0.5 rounded-full"
                                                  :class="v.status==='deployed' ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-500'"
                                                  x-text="v.status==='deployed' ? 'Î∞∞Ìè¨Îê®' : 'ÏïÑÏπ¥Ïù¥Î∏å'"></span>
                                        </td>
                                        <td class="py-2 pr-3 text-slate-500 text-center" x-text="v.nodes"></td>
                                        <td class="py-2 text-right">
                                            <div class="flex items-center justify-end gap-1">
                                                <button class="p-1 text-slate-400 hover:text-slate-600 rounded" title="ÏÉÅÏÑ∏ Î≥¥Í∏∞"><i data-lucide="eye" class="w-3.5 h-3.5"></i></button>
                                                <button class="p-1 text-slate-400 hover:text-amber-600 rounded" title="Î°§Î∞±" x-show="v.status!=='deployed'"><i data-lucide="rotate-ccw" class="w-3.5 h-3.5"></i></button>
                                                <button class="p-1 text-slate-400 hover:text-slate-600 rounded" title="Îã§Ïö¥Î°úÎìú"><i data-lucide="download" class="w-3.5 h-3.5"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<script>
document.addEventListener('alpine:init', () => { setTimeout(() => lucide.createIcons(), 50); });

function workflowBuilder() {
    return {
        selectedNode: 'n2',
        paletteSearch: '',
        openCategories: ['detection','classification'],
        showVersions: false,
        zoom: 100,

        nodeInfo: {
            n1: { label: 'Ïù¥ÏÉÅÍ±∞Îûò ÌÉêÏßÄ', desc: 'FDS Î™®Îç∏ Í∏∞Î∞ò Ïã§ÏãúÍ∞Ñ Ïù¥ÏÉÅÍ±∞Îûò ÌÉêÏßÄ', type: 'detection' },
            n2: { label: 'ÏúÑÌóòÎèÑ Î∂ÑÎ•ò', desc: 'Í≥†ÏúÑÌóò/Ï§ëÏúÑÌóò/Ï†ÄÏúÑÌóò ÏûêÎèô Î∂ÑÎ•ò', type: 'classification' },
            n3: { label: 'ÏûÑÍ≥ÑÍ∞í Î∂ÑÍ∏∞', desc: 'ÏúÑÌóò Ï†êÏàò Í∏∞Ï§Ä Ï°∞Í±¥ Î∂ÑÍ∏∞', type: 'condition' },
            n4: { label: 'ÏûêÎèô Ï∞®Îã®', desc: 'Í≥†ÏúÑÌóò Í±∞Îûò ÏûêÎèô Ï∞®Îã®', type: 'response' },
            n5: { label: 'ÏàòÎèô Í≤ÄÌÜ† ÎåÄÍ∏∞', desc: 'Îã¥ÎãπÏûê ÏàòÎèô Í≤ÄÌÜ† ÎåÄÍ∏∞Ïó¥Ïóê Ï∂îÍ∞Ä', type: 'response' },
            n6: { label: 'Slack ÏïåÎ¶º', desc: 'Slack Ï±ÑÎÑê ÏïåÎ¶º Î∞úÏÜ°', type: 'notification' },
            n7: { label: 'Ïù¥Î©îÏùº ÏïåÎ¶º', desc: 'Ïù¥Î©îÏùº ÏïåÎ¶º Î∞úÏÜ°', type: 'notification' },
            n8: { label: 'Ïù∏ÏãúÎçòÌä∏ Î¶¨Ìè¨Ìä∏', desc: 'ÏÇ¨Í±¥ Î≥¥Í≥†ÏÑú ÏûêÎèô ÏÉùÏÑ±', type: 'report' }
        },

        categories: [
            { id:'detection', label:'ÌÉêÏßÄ', icon:'shield', color:'blue', nodes:[
                { id:'fds_detect', label:'Ïù¥ÏÉÅÍ±∞Îûò ÌÉêÏßÄ', icon:'shield', desc:'FDS Î™®Îç∏ Í∏∞Î∞ò Ïã§ÏãúÍ∞Ñ ÌÉêÏßÄ' },
                { id:'aml_detect', label:'AML Î™®ÎãàÌÑ∞ÎßÅ', icon:'search', desc:'ÏûêÍ∏àÏÑ∏ÌÉÅ ÏùòÏã¨ Í±∞Îûò ÌÉêÏßÄ' },
                { id:'insider_detect', label:'ÎÇ¥Î∂Ä Ïú†Ï∂ú ÌÉêÏßÄ', icon:'lock', desc:'ÎÇ¥Î∂Ä Ï†ïÎ≥¥ Ïú†Ï∂ú Ìå®ÌÑ¥ Í∞êÏßÄ' },
                { id:'access_anomaly', label:'Ï†ëÍ∑º Í∂åÌïú Ïù¥ÏÉÅ', icon:'user-x', desc:'ÎπÑÏ†ïÏÉÅ Ï†ëÍ∑º Ìå®ÌÑ¥ ÌÉêÏßÄ' }
            ]},
            { id:'classification', label:'Î∂ÑÎ•ò', icon:'bar-chart-3', color:'indigo', nodes:[
                { id:'risk_classifier', label:'ÏúÑÌóòÎèÑ Î∂ÑÎ•ò', icon:'bar-chart-3', desc:'Í≥†/Ï§ë/Ï†ÄÏúÑÌóò ÏûêÎèô Î∂ÑÎ•ò' },
                { id:'custom_rule', label:'Ïª§Ïä§ÌÖÄ Í∑úÏπô', icon:'settings', desc:'ÏÇ¨Ïö©Ïûê Ï†ïÏùò Î∂ÑÎ•ò Í∑úÏπô' }
            ]},
            { id:'notification', label:'ÏïåÎ¶º', icon:'bell', color:'emerald', nodes:[
                { id:'slack_alert', label:'Slack ÏïåÎ¶º', icon:'message-square', desc:'Slack Ï±ÑÎÑê ÏïåÎ¶º Î∞úÏÜ°' },
                { id:'email_alert', label:'Ïù¥Î©îÏùº ÏïåÎ¶º', icon:'mail', desc:'Ïù¥Î©îÏùº ÏïåÎ¶º Î∞úÏÜ°' },
                { id:'sms_alert', label:'SMS ÏïåÎ¶º', icon:'phone', desc:'SMS ÏïåÎ¶º Î∞úÏÜ°' },
                { id:'teams_alert', label:'Teams ÏïåÎ¶º', icon:'message-circle', desc:'MS Teams ÏïåÎ¶º Î∞úÏÜ°' }
            ]},
            { id:'response', label:'ÎåÄÏùë', icon:'zap', color:'red', nodes:[
                { id:'auto_block', label:'ÏûêÎèô Ï∞®Îã®', icon:'ban', desc:'Í≥†ÏúÑÌóò Í±∞Îûò ÏûêÎèô Ï∞®Îã®' },
                { id:'manual_review', label:'ÏàòÎèô Í≤ÄÌÜ† ÎåÄÍ∏∞', icon:'eye', desc:'Îã¥ÎãπÏûê ÏàòÎèô Í≤ÄÌÜ† ÎåÄÍ∏∞Ïó¥' },
                { id:'escalation', label:'ÏóêÏä§Ïª¨Î†àÏù¥ÏÖò', icon:'arrow-up-circle', desc:'ÏÉÅÏúÑ Îã¥ÎãπÏûê ÏóêÏä§Ïª¨Î†àÏù¥ÏÖò' }
            ]},
            { id:'report', label:'Î¶¨Ìè¨Ìä∏', icon:'file-text', color:'violet', nodes:[
                { id:'incident_report', label:'Ïù∏ÏãúÎçòÌä∏ Î¶¨Ìè¨Ìä∏', icon:'file-text', desc:'ÏÇ¨Í±¥ Î≥¥Í≥†ÏÑú ÏûêÎèô ÏÉùÏÑ±' },
                { id:'compliance_log', label:'Ïª¥ÌîåÎùºÏù¥Ïñ∏Ïä§ Î°úÍ∑∏', icon:'clipboard-list', desc:'Í∑úÏ†ú Í∞êÏÇ¨Ïö© Î°úÍ∑∏ Í∏∞Î°ù' }
            ]},
            { id:'condition', label:'Ï°∞Í±¥', icon:'git-branch', color:'amber', nodes:[
                { id:'threshold_gate', label:'ÏûÑÍ≥ÑÍ∞í Î∂ÑÍ∏∞', icon:'git-branch', desc:'ÏûÑÍ≥ÑÍ∞í Í∏∞Ï§Ä Ï°∞Í±¥ Î∂ÑÍ∏∞' },
                { id:'time_window', label:'ÏãúÍ∞Ñ ÏúàÎèÑÏö∞', icon:'clock', desc:'ÌäπÏ†ï ÏãúÍ∞ÑÎåÄ Ï°∞Í±¥ Î∂ÑÍ∏∞' },
                { id:'amount_filter', label:'Í∏àÏï° ÌïÑÌÑ∞', icon:'dollar-sign', desc:'Í±∞Îûò Í∏àÏï° Í∏∞Ï§Ä Î∂ÑÍ∏∞' }
            ]}
        ],

        versions: [
            { version:'v2.1', date:'2026-02-06 14:32', author:'ÍπÄÎ∂ÄÏû•', summary:'ÏûêÎèô Ï∞®Îã® ÏûÑÍ≥ÑÍ∞í 90‚Üí85 Ï°∞Ï†ï', status:'deployed', nodes:8 },
            { version:'v2.0', date:'2026-02-05 10:15', author:'ÍπÄÎ∂ÄÏû•', summary:'ÏûÑÍ≥ÑÍ∞í Î∂ÑÍ∏∞ ÎÖ∏Îìú Ï∂îÍ∞Ä', status:'archived', nodes:8 },
            { version:'v1.2', date:'2026-01-28 16:45', author:'Ïù¥Í≥ºÏû•', summary:'SMS ÏïåÎ¶º Ï±ÑÎÑê Ï∂îÍ∞Ä', status:'archived', nodes:7 },
            { version:'v1.1', date:'2026-01-20 09:30', author:'ÍπÄÎ∂ÄÏû•', summary:'Slack ÏïåÎ¶º ÌÖúÌîåÎ¶ø ÏàòÏ†ï', status:'archived', nodes:6 },
            { version:'v1.0', date:'2026-01-15 11:00', author:'ÍπÄÎ∂ÄÏû•', summary:'Ï¥àÍ∏∞ ÏõåÌÅ¨ÌîåÎ°úÏö∞ ÏÉùÏÑ±', status:'archived', nodes:5 }
        ],

        get filteredCategories() {
            if (!this.paletteSearch) return this.categories;
            const q = this.paletteSearch.toLowerCase();
            return this.categories.map(c => ({
                ...c,
                nodes: c.nodes.filter(n => n.label.toLowerCase().includes(q) || n.desc.toLowerCase().includes(q))
            })).filter(c => c.nodes.length > 0);
        },

        toggleCategory(id) {
            const i = this.openCategories.indexOf(id);
            if (i >= 0) this.openCategories.splice(i, 1); else this.openCategories.push(id);
        },

        isCategoryOpen(id) { return this.openCategories.includes(id); },

        selectNode(id) {
            this.selectedNode = this.selectedNode === id ? null : id;
            this.$nextTick(() => lucide.createIcons());
        },

        init() { this.$nextTick(() => { try { lucide.createIcons(); } catch(e) { console.warn('Lucide init:', e); } }); }
    };
}
</script>
</body>
</html>
